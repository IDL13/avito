package app

import (
	"fmt"
	"log"
	"net/http"
	"time"

	"github.com/IDL13/avito/internal/handler"
)

type App struct {
	s *http.Server
	h *handler.Handler
}

func New() *App {
	a := &App{
		s: &http.Server{
			Addr:           ":8080",
			ReadTimeout:    10 * time.Second,
			WriteTimeout:   10 * time.Second,
			MaxHeaderBytes: 1 << 20,
		},
	}
	http.HandleFunc("/", a.h.StartServer)
	http.HandleFunc("/create_segment", a.h.CreateSegment)
	http.HandleFunc("/deleting_segment", a.h.DeletingSegment)
	http.HandleFunc("/adding_user_to_segment", a.h.AddingUserToSegment)
	http.HandleFunc("/deliting_user_segment", a.h.DeletingUserSegments)
	http.HandleFunc("/getting_active_user_segments", a.h.GettingActiveUserSegments)
	return a
}

func (a *App) Run() {
	fmt.Println(`___________________________________††_ 
	_________________________________‡††‡††_†_ 
	__________________________†††_††88‡‡‡†_††† 
	____________ ____________††_†_‡‡‡¶¶88‡‡‡__†_ 
	______________________‡†_†¶¶¶¶¶¶8¶†††††‡††††† 
	________________†__†_†¶¶¶88¶†¶†8¶¶¶†_†††‡‡__††_ 
	___________ ___†___††88††††††††‡____8‡__†‡†_††‡‡† 
	______________†††††88††††††††_‡_††_†††††‡‡_¶‡‡‡ 
	______________††††‡8‡‡†††††††_†_‡_†††‡††‡¶†‡‡8_ 
	___ ____________††‡8¶¶¶‡†¶¶††¶__†8_¶¶†‡_††¶8¶¶¶¶¶¶† 
	________________††88‡††‡†¶¶¶¶¶†‡‡†¶‡‡††8‡88‡¶¶¶¶‡‡‡ 
	_________________‡‡‡‡†‡†††††††††‡†¶††† ‡‡8¶‡‡†¶¶8¶‡† 
	__________________‡8‡‡†‡‡††††‡‡†††‡8‡¶¶88†¶‡¶‡¶¶¶8† 
	___________________‡8‡‡‡‡‡‡‡888¶†‡‡_¶¶¶¶‡†‡8‡88‡8¶8_ 
	__________________ ‡†‡††‡‡‡‡888¶8¶¶8†‡¶88¶‡8¶‡¶¶¶‡‡ 
	_____________________‡‡††‡‡‡‡888¶¶8‡¶¶¶††¶¶88¶¶¶¶¶‡‡ 
	_____________________‡‡†8¶8¶¶¶¶‡‡¶¶¶¶¶¶‡‡¶†8‡8¶8¶¶ 8‡ 
	________________________‡8¶¶¶‡†‡¶¶¶¶¶¶¶‡‡¶88†8¶¶¶¶88 
	_________________†††††‡‡‡‡88888‡‡8¶¶¶8¶¶¶‡8‡†¶8¶¶¶‡8 
	___________††_†‡‡†††__††8888 8¶¶888¶¶¶¶¶¶8†¶¶††¶¶¶¶8† 
	________†††††††‡¶†_____†‡‡‡‡88¶¶¶8¶¶¶‡¶¶¶¶‡¶‡‡¶¶¶¶8‡ 
	_____‡††††††‡¶¶‡†______†‡‡‡‡8888¶¶¶¶¶8¶¶¶†¶¶†¶¶¶¶¶8‡ 
	___‡†† _††‡8¶¶¶¶‡†_____†††‡‡‡888¶¶¶¶¶¶¶¶¶¶¶‡88¶88¶¶‡8 
	___†††‡¶¶¶‡___‡†______††‡‡‡888¶¶¶¶8¶¶¶¶‡¶¶8¶88¶¶¶8†¶ 
	___†††‡‡__88‡‡††_____††‡‡‡88¶¶¶¶¶88¶88 ¶†8¶¶88†¶8‡¶† 
	___††††‡¶8††_‡††___††‡‡8¶‡‡8¶¶¶¶88¶¶8¶¶¶¶¶¶88¶_‡‡‡ 
	___‡†††‡88†_‡†††___††‡8¶¶‡88¶¶¶¶¶¶¶8‡8¶¶¶¶¶¶¶__‡¶† 
	___‡†††‡8¶‡‡‡††___††‡ 8¶¶8‡88¶¶¶¶¶¶8¶8¶¶¶¶¶¶__8¶¶ 
	___‡†††‡8¶8†††____†‡8¶¶¶88¶¶¶¶¶¶¶8¶¶¶¶‡8¶†¶__† 
	___‡†††‡‡8‡††___†††888¶¶¶¶¶¶¶¶¶¶8¶¶¶8¶¶_¶‡¶¶ 
	___‡†††‡‡8‡†____† ‡‡8¶¶¶¶¶¶¶¶¶¶¶8¶¶¶8_¶¶88¶_††_‡ 
	___‡‡†††‡‡†___†††‡8¶8¶¶¶¶¶¶¶¶¶¶¶¶¶†____‡‡_¶__†_ 
	___†‡†††‡††††††‡‡8¶8¶¶¶¶¶¶¶¶‡¶¶¶8‡_________†_‡‡† 
	____†‡††‡ ††‡‡‡‡‡8¶8¶¶¶¶¶¶¶8¶¶¶¶8 
	____†‡‡‡†‡‡‡‡‡‡8¶8¶¶¶¶¶¶¶8¶¶¶¶8 
	____‡‡‡‡‡‡‡‡‡88¶¶¶¶¶¶¶¶¶¶¶¶¶¶‡ 
	____‡††††‡‡88¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶‡ 
	____‡‡‡8888¶¶¶¶¶¶¶¶ ¶¶¶8¶¶¶8 
	____‡‡‡‡¶¶¶¶¶8888¶¶¶¶¶¶¶¶8 
	____†‡††††††††‡‡888¶¶¶¶¶¶8 
	___†‡†††††††††‡‡888¶¶¶8¶¶8 
	___‡†††††††††††‡‡888¶¶¶¶¶¶8† 
	___††††††††††††† ‡‡‡888¶¶¶¶8‡‡ 
	___††††††††††††‡‡¶¶¶¶¶¶¶¶¶¶¶8‡ 
	___†‡†††††_¶¶¶††††‡‡‡‡‡8888¶¶8¶8 
	___†††††¶8†††††††††‡‡‡‡‡‡8888¶¶¶¶¶ 
	___†‡¶¶††††††††††††††‡‡ ‡‡‡‡888¶¶¶¶¶‡ 
	___†¶‡†††††††††††††††††‡‡‡‡888¶¶¶¶¶¶¶ 
	___8‡‡‡††††††††††††††††‡‡‡‡888¶¶8¶¶¶¶† 
	___‡‡‡‡††††††††††††††††‡‡‡‡888¶¶8¶¶¶¶¶ 
	___‡‡‡ ‡†††††††††††††††‡‡‡‡888¶¶¶8¶¶¶¶8‡ 
	___‡‡‡††††††††††‡†††‡‡‡‡‡888¶¶¶¶‡¶¶¶¶8‡ 
	__†‡‡‡†††††††††††‡†‡†‡‡‡888¶¶¶¶8¶¶¶¶¶88 
	__†‡‡‡††††††††‡†††‡‡‡‡‡ ‡88¶¶¶¶¶8¶¶¶¶¶8‡ 
	__†‡‡‡‡††††††††‡‡‡‡‡‡‡‡88¶¶¶¶88¶¶¶¶¶¶8 
	_††‡‡‡††††††††‡‡‡‡‡‡‡888¶¶¶¶8¶¶¶¶¶¶¶¶8 
	_††‡‡‡‡††††‡‡‡‡‡‡‡‡888¶¶¶¶¶8¶¶¶¶¶¶¶¶¶ 
	_†† ‡‡‡‡‡‡‡‡‡‡‡‡‡‡8888¶¶¶¶¶8¶¶¶¶¶¶¶¶¶† 
	_†‡‡‡‡‡‡‡‡‡‡‡‡‡‡8888¶¶¶¶¶¶¶¶¶¶¶¶¶¶8 
	_††‡‡‡‡‡‡‡‡‡‡‡‡8888¶¶¶¶¶¶8¶¶¶¶¶¶¶¶ 
	_†‡‡‡‡‡‡‡‡‡‡‡8888¶¶¶¶¶¶¶8¶¶¶¶¶¶ ¶8† 
	_††‡‡‡‡‡‡‡‡‡‡888¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶¶ 
	_††‡‡‡‡‡‡‡‡‡‡8888¶¶¶¶¶¶8¶¶¶¶¶¶¶‡ 
	__†‡‡‡‡‡‡‡‡‡‡8888¶¶¶¶¶8¶¶¶¶¶¶¶‡ 
	__‡‡‡‡‡‡‡‡‡‡‡888¶¶¶¶¶¶‡¶¶¶¶¶¶8 
	 †‡‡‡‡‡‡‡‡8‡888¶¶¶¶¶¶¶¶¶¶¶¶8 
	___‡‡‡‡‡‡‡‡‡8888¶¶¶¶¶‡¶¶¶¶¶8† 
	___‡‡‡‡‡‡‡‡‡888¶¶¶¶¶¶¶¶¶¶¶8‡ 
	___‡‡8‡‡‡‡‡8888¶¶¶¶¶‡¶¶¶¶¶8`)
	fmt.Println("[SERVER STARTED]")
	log.Fatal(a.s.ListenAndServe())
}
